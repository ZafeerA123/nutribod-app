<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedPrep Tracker - Enhanced Health Monitoring</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Animated Background -->
    <div class="animated-bg">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
        <div class="gradient-orb orb-3"></div>
        <div class="floating-particles">
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
        </div>
    </div>

    <!-- Header with Glassmorphism -->
    <header class="header">
        <div class="container">
            <div class="logo-section">
                <div class="logo-icon">
                    <svg viewBox="0 0 50 50" class="heartbeat-icon">
                        <path d="M25 45 C25 45 5 25 5 15 C5 5 15 5 25 15 C35 5 45 5 45 15 C45 25 25 45 25 45 Z" fill="currentColor"/>
                        <line x1="10" y1="25" x2="40" y2="25" stroke="currentColor" stroke-width="2" class="heartbeat-line"/>
                        <polyline points="15,25 20,15 25,35 30,10 35,25" stroke="currentColor" stroke-width="2" fill="none" class="heartbeat-pulse"/>
                    </svg>
                </div>
                <div class="logo-text">
                    <h1>MedPrep Tracker</h1>
                    <p>Smart symptom tracking with life impact analysis</p>
                </div>
            </div>
            <div class="disclaimer">
                <div class="disclaimer-icon">‚öïÔ∏è</div>
                <span><strong>Medical Tool Only:</strong> This tracks symptoms for your records. Always consult healthcare professionals for medical advice.</span>
            </div>
        </div>
    </header>

    <!-- Authentication Section -->
    <div id="auth-container" class="auth-container">
        <div class="auth-card glass-card">
            <div class="auth-header">
                <div class="auth-icon">üîê</div>
                <h2>Sign In to MedPrep Tracker</h2>
                <p>Your health data will be securely stored and only accessible to you</p>
            </div>
            
            <div class="auth-methods">
                <button class="auth-btn google-btn" onclick="signInWithGoogle()">
                    <svg viewBox="0 0 24 24" class="google-icon">
                        <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                        <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                        <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                        <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                    </svg>
                    Continue with Google
                </button>
                
                <div class="auth-divider"><span>or</span></div>
                
                <button class="auth-btn email-toggle-btn" onclick="toggleEmailAuth()">
                    <span class="auth-icon">üìß</span>
                    Sign in with Email
                </button>
                
                <div id="email-auth-form" class="email-auth-form" style="display: none;">
                    <div class="form-group">
                        <input type="email" id="auth-email" class="form-input" placeholder="Enter your email">
                    </div>
                    <div class="form-group">
                        <input type="password" id="auth-password" class="form-input" placeholder="Enter your password">
                    </div>
                    <div class="auth-form-buttons">
                        <button class="auth-btn" onclick="signInWithEmail()">Sign In</button>
                        <button class="auth-btn secondary" onclick="signUpWithEmail()">Create Account</button>
                    </div>
                </div>
                
                <div class="auth-divider"><span>or</span></div>
                
                <button class="auth-btn anonymous-btn" onclick="signInAnonymously()">
                    <span class="auth-icon">üë§</span>
                    Try Without Account (Demo Mode)
                </button>
            </div>
            
            <div class="privacy-notice">
                <p>üîí Your health data is encrypted and stored securely. We never share personal information.</p>
            </div>
        </div>
    </div>

    <!-- User Profile Section -->
    <div id="user-profile" class="user-profile" style="display: none;">
        <div class="profile-info">
            <img id="user-avatar" class="user-avatar" src="" alt="User">
            <div class="user-details">
                <span id="user-name" class="user-name"></span>
                <span id="user-email" class="user-email"></span>
            </div>
        </div>
        <button class="btn-secondary" onclick="signOut()">Sign Out</button>
    </div>

    <!-- Navigation with Modern Pills -->
    <nav class="nav-container">
        <div class="nav-tabs">
            <button class="tab-btn active" onclick="switchTab('tracker')" data-tab="tracker">
                <span class="tab-icon">üéØ</span>
                <span>Body Map</span>
            </button>
            <button class="tab-btn" onclick="switchTab('sleep')" data-tab="sleep">
                <span class="tab-icon">üò¥</span>
                <span>Sleep</span>
            </button>
            <button class="tab-btn" onclick="switchTab('history')" data-tab="history">
                <span class="tab-icon">üìä</span>
                <span>History</span>
            </button>
            <button class="tab-btn" onclick="switchTab('appointment')" data-tab="appointment">
                <span class="tab-icon">üìã</span>
                <span>Appointment</span>
            </button>
            <button class="tab-btn" onclick="switchTab('reports')" data-tab="reports">
                <span class="tab-icon">üìÑ</span>
                <span>Reports</span>
            </button>
        </div>
    </nav>

    <div class="container">
        <!-- Body Map Tracker Tab -->
        <div id="tracker" class="tab-content active">
            <div class="tracker-grid">
                <!-- Interactive Body Map -->
                <div class="body-map-card">
                    <div class="card-header">
                        <h2>Where are you experiencing symptoms?</h2>
                        <p>Click on any body region to log a symptom</p>
                    </div>
                    
                    <div class="body-diagram" id="body-diagram">
                        <svg viewBox="0 0 400 700" class="body-svg">
                            <!-- Head -->
                            <path d="M 200 30 C 230 30 250 50 250 80 C 250 95 245 105 240 110 C 235 115 225 120 200 120 C 175 120 165 115 160 110 C 155 105 150 95 150 80 C 150 50 170 30 200 30 Z" class="body-part hoverable" data-region="head" />
                            <text x="200" y="75" class="body-label">Head</text>
                            
                            <!-- Neck -->
                            <rect x="185" y="115" width="30" height="25" rx="8" class="body-part hoverable" data-region="neck" />
                            <text x="200" y="130" class="body-label small">Neck</text>
                            
                            <!-- Shoulders -->
                            <ellipse cx="155" cy="155" rx="20" ry="15" class="body-part hoverable" data-region="left-shoulder" />
                            <ellipse cx="245" cy="155" rx="20" ry="15" class="body-part hoverable" data-region="right-shoulder" />
                            <text x="155" y="160" class="body-label small">L.Shoulder</text>
                            <text x="245" y="160" class="body-label small">R.Shoulder</text>
                            
                            <!-- Upper Arms -->
                            <ellipse cx="135" cy="190" rx="15" ry="35" class="body-part hoverable" data-region="left-upper-arm" />
                            <ellipse cx="265" cy="190" rx="15" ry="35" class="body-part hoverable" data-region="right-upper-arm" />
                            
                            <!-- Elbows -->
                            <circle cx="135" cy="225" r="12" class="body-part hoverable" data-region="left-elbow" />
                            <circle cx="265" cy="225" r="12" class="body-part hoverable" data-region="right-elbow" />
                            
                            <!-- Forearms -->
                            <ellipse cx="135" cy="260" rx="12" ry="35" class="body-part hoverable" data-region="left-forearm" />
                            <ellipse cx="265" cy="260" rx="12" ry="35" class="body-part hoverable" data-region="right-forearm" />
                            
                            <!-- Hands -->
                            <ellipse cx="135" cy="300" rx="10" ry="20" class="body-part hoverable" data-region="left-hand" />
                            <ellipse cx="265" cy="300" rx="10" ry="20" class="body-part hoverable" data-region="right-hand" />
                            <text x="135" y="305" class="body-label small">L.Hand</text>
                            <text x="265" y="305" class="body-label small">R.Hand</text>
                            
                            <!-- Torso -->
                            <path d="M 170 140 C 170 140 170 150 175 155 L 175 180 C 175 190 180 200 185 205 L 215 205 C 220 200 225 190 225 180 L 225 155 C 230 150 230 140 230 140 C 235 145 240 150 240 160 L 240 200 C 240 210 235 220 225 225 L 175 225 C 165 220 160 210 160 200 L 160 160 C 160 150 165 145 170 140 Z" class="body-part hoverable" data-region="chest" />
                            <text x="200" y="190" class="body-label">Chest</text>
                            
                            <!-- Abdomen -->
                            <ellipse cx="200" cy="260" rx="60" ry="35" class="body-part hoverable" data-region="abdomen" />
                            <text x="200" y="265" class="body-label">Abdomen</text>
                            
                            <!-- Lower Back -->
                            <ellipse cx="200" cy="300" rx="50" ry="20" class="body-part hoverable" data-region="lower-back" />
                            <text x="200" y="305" class="body-label">Lower Back</text>
                            
                            <!-- Pelvis -->
                            <path d="M 160 320 C 155 325 155 335 160 340 L 180 345 L 220 345 C 240 345 245 335 245 325 C 245 320 240 320 235 322 L 165 322 C 160 320 160 320 160 320 Z" class="body-part hoverable" data-region="pelvis" />
                            <text x="200" y="335" class="body-label">Pelvis</text>
                            
                            <!-- Thighs -->
                            <ellipse cx="175" cy="400" rx="20" ry="50" class="body-part hoverable" data-region="left-thigh" />
                            <ellipse cx="225" cy="400" rx="20" ry="50" class="body-part hoverable" data-region="right-thigh" />
                            <text x="175" y="405" class="body-label small">L.Thigh</text>
                            <text x="225" y="405" class="body-label small">R.Thigh</text>
                            
                            <!-- Knees -->
                            <circle cx="175" cy="450" r="15" class="body-part hoverable" data-region="left-knee" />
                            <circle cx="225" cy="450" r="15" class="body-part hoverable" data-region="right-knee" />
                            <text x="175" y="455" class="body-label small">L.Knee</text>
                            <text x="225" y="455" class="body-label small">R.Knee</text>
                            
                            <!-- Calves -->
                            <ellipse cx="175" cy="500" rx="18" ry="45" class="body-part hoverable" data-region="left-calf" />
                            <ellipse cx="225" cy="500" rx="18" ry="45" class="body-part hoverable" data-region="right-calf" />
                            <text x="175" y="505" class="body-label small">L.Calf</text>
                            <text x="225" y="505" class="body-label small">R.Calf</text>
                            
                            <!-- Ankles -->
                            <circle cx="175" cy="545" r="10" class="body-part hoverable" data-region="left-ankle" />
                            <circle cx="225" cy="545" r="10" class="body-part hoverable" data-region="right-ankle" />
                            
                            <!-- Feet -->
                            <ellipse cx="175" cy="570" rx="12" ry="25" class="body-part hoverable" data-region="left-foot" />
                            <ellipse cx="225" cy="570" rx="12" ry="25" class="body-part hoverable" data-region="right-foot" />
                            <text x="175" y="575" class="body-label small">L.Foot</text>
                            <text x="225" y="575" class="body-label small">R.Foot</text>
                        </svg>
                    </div>
                </div>

                <!-- Enhanced Symptom Input Form with Life Impact -->
                <div class="symptom-form-card">
                    <div id="symptom-form" class="symptom-form" style="display: none;">
                        <div class="form-header">
                            <h3>Log Symptom Details</h3>
                            <div class="selected-region-display" id="region-display"></div>
                        </div>
                        
                        <div class="form-body">
                            <div class="form-group">
                                <label class="form-label">Symptom Type</label>
                                <select id="symptom-type" class="form-input">
                                    <option value="">Select type...</option>
                                    <option value="pain">Pain</option>
                                    <option value="ache">Ache</option>
                                    <option value="stiffness">Stiffness</option>
                                    <option value="swelling">Swelling</option>
                                    <option value="numbness">Numbness</option>
                                    <option value="tingling">Tingling</option>
                                    <option value="nausea">Nausea</option>
                                    <option value="fatigue">Fatigue</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Description</label>
                                <input type="text" id="symptom-description" class="form-input" placeholder="e.g., sharp stabbing pain, dull headache">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Severity</label>
                                <div class="severity-slider">
                                    <input type="range" id="severity" min="1" max="10" value="5" class="slider">
                                    <div class="severity-display">
                                        <span class="severity-number" id="severity-display">5</span>
                                        <span class="severity-label">Moderate</span>
                                    </div>
                                </div>
                            </div>

                            <!-- NEW: Life Impact Assessment -->
                            <div class="form-group life-impact-section">
                                <label class="form-label">How did this symptom affect your daily life?</label>
                                
                                <div class="impact-category">
                                    <h4>Work/School Impact</h4>
                                    <div class="radio-group">
                                        <label class="radio-option">
                                            <input type="radio" name="work-impact" value="none">
                                            <span class="radio-custom"></span>
                                            No impact
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="work-impact" value="mild">
                                            <span class="radio-custom"></span>
                                            Mild (slight distraction)
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="work-impact" value="moderate">
                                            <span class="radio-custom"></span>
                                            Moderate (missed tasks/meetings)
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="work-impact" value="severe">
                                            <span class="radio-custom"></span>
                                            Severe (couldn't work/study)
                                        </label>
                                    </div>
                                </div>

                                <div class="impact-category">
                                    <h4>Sleep Impact</h4>
                                    <div class="radio-group">
                                        <label class="radio-option">
                                            <input type="radio" name="sleep-impact" value="none">
                                            <span class="radio-custom"></span>
                                            No impact
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="sleep-impact" value="mild">
                                            <span class="radio-custom"></span>
                                            Mild (slightly harder to sleep)
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="sleep-impact" value="moderate">
                                            <span class="radio-custom"></span>
                                            Moderate (woke up multiple times)
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="sleep-impact" value="severe">
                                            <span class="radio-custom"></span>
                                            Severe (couldn't sleep)
                                        </label>
                                    </div>
                                </div>

                                <div class="impact-category">
                                    <h4>Social Impact</h4>
                                    <div class="radio-group">
                                        <label class="radio-option">
                                            <input type="radio" name="social-impact" value="none">
                                            <span class="radio-custom"></span>
                                            No impact
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="social-impact" value="mild">
                                            <span class="radio-custom"></span>
                                            Mild (less social)
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="social-impact" value="moderate">
                                            <span class="radio-custom"></span>
                                            Moderate (avoided some activities)
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="social-impact" value="severe">
                                            <span class="radio-custom"></span>
                                            Severe (cancelled plans/events)
                                        </label>
                                    </div>
                                </div>

                                <div class="impact-category">
                                    <h4>Mobility Impact</h4>
                                    <div class="radio-group">
                                        <label class="radio-option">
                                            <input type="radio" name="mobility-impact" value="none">
                                            <span class="radio-custom"></span>
                                            No impact
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="mobility-impact" value="mild">
                                            <span class="radio-custom"></span>
                                            Mild (moved more slowly)
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="mobility-impact" value="moderate">
                                            <span class="radio-custom"></span>
                                            Moderate (needed assistance)
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="mobility-impact" value="severe">
                                            <span class="radio-custom"></span>
                                            Severe (couldn't move normally)
                                        </label>
                                    </div>
                                </div>

                                <div class="impact-category">
                                    <h4>Mood Impact</h4>
                                    <div class="radio-group">
                                        <label class="radio-option">
                                            <input type="radio" name="mood-impact" value="none">
                                            <span class="radio-custom"></span>
                                            No impact
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="mood-impact" value="mild">
                                            <span class="radio-custom"></span>
                                            Mild (slightly irritated)
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="mood-impact" value="moderate">
                                            <span class="radio-custom"></span>
                                            Moderate (frustrated/anxious)
                                        </label>
                                        <label class="radio-option">
                                            <input type="radio" name="mood-impact" value="severe">
                                            <span class="radio-custom"></span>
                                            Severe (very distressed)
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">When did it start?</label>
                                <input type="datetime-local" id="symptom-time" class="form-input">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Additional notes</label>
                                <textarea id="symptom-notes" class="form-textarea" placeholder="Any triggers, patterns, or other details..."></textarea>
                            </div>
                            
                            <div class="form-actions">
                                <button class="btn-primary" onclick="saveSymptom()">
                                    <span class="btn-icon">üíæ</span>
                                    Log Symptom
                                </button>
                                <button class="btn-secondary" onclick="clearForm()">Clear</button>
                            </div>
                        </div>
                    </div>
                    
                    <div id="instruction-text" class="instruction-card">
                        <div class="instruction-icon">üëÜ</div>
                        <h3>Get Started</h3>
                        <p>Click on any body part to begin logging your symptoms with life impact analysis</p>
                        <div class="quick-stats">
                            <div class="stat">
                                <span class="stat-number" id="total-symptoms">0</span>
                                <span class="stat-label">Symptoms Logged</span>
                            </div>
                            <div class="stat">
                                <span class="stat-number" id="this-week">0</span>
                                <span class="stat-label">This Week</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- NEW: Sleep Tracker Tab -->
        <div id="sleep" class="tab-content">
            <div class="section-header">
                <h2>Sleep Tracking</h2>
                <p>Monitor your sleep patterns and their connection to your symptoms</p>
            </div>
            
            <div class="tracker-grid">
                <div class="sleep-form-card glass-card">
                    <div class="card-icon">üò¥</div>
                    <h3>Log Sleep Session</h3>
                    
                    <div class="form-body">
                        <div class="form-group">
                            <label class="form-label">Bedtime</label>
                            <input type="datetime-local" id="bedtime" class="form-input">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Wake Time</label>
                            <input type="datetime-local" id="waketime" class="form-input">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Sleep Quality</label>
                            <div class="severity-slider">
                                <input type="range" id="sleep-quality" min="1" max="5" value="3" class="slider">
                                <div class="severity-display">
                                    <span class="severity-number" id="sleep-quality-display">3</span>
                                    <span class="sleep-quality-label">Fair</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Sleep Notes</label>
                            <textarea id="sleep-notes" class="form-textarea" placeholder="How did you feel? Any disruptions, dreams, or factors that affected your sleep?"></textarea>
                        </div>
                        
                        <div class="form-actions">
                            <button class="btn-primary" id="save-sleep-btn" onclick="saveSleep()">
                                <span class="btn-icon">üíæ</span>
                                Log Sleep
                            </button>
                            <button class="btn-secondary" onclick="exportSleepData()">
                                <span class="btn-icon">üì•</span>
                                Export Data
                            </button>
                        </div>
                    </div>
                </div>

                <div class="sleep-stats-card glass-card">
                    <div class="card-icon">üìä</div>
                    <h3>Sleep Overview</h3>
                    <div id="sleep-stats" class="quick-stats">
                        <div class="stat">
                            <span class="stat-number">0</span>
                            <span class="stat-label">Sessions Logged</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number">0h</span>
                            <span class="stat-label">Avg Duration</span>
                        </div>
                    </div>
                    
                    <div class="sleep-timeline-container">
                        <h4>Recent Sleep Sessions</h4>
                        <div id="sleep-timeline" class="timeline">
                            <p style="color: rgba(255,255,255,0.6); text-align: center; padding: 40px;">No sleep data logged yet. Start tracking your sleep patterns!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced History Tab -->
        <div id="history" class="tab-content">
            <div class="section-header">
                <h2>Health History & Impact Analysis</h2>
                <p>Review your symptoms, life impact patterns, and health insights</p>
            </div>
            
            <div class="history-controls">
                <div class="filter-group">
                    <select id="filter-region" class="form-input">
                        <option value="">All body regions</option>
                    </select>
                    <input type="date" id="filter-date" class="form-input" onchange="filterHistory()">
                    <button class="btn-secondary" onclick="filterHistory()">Filter</button>
                </div>
            </div>
            
            <div class="history-grid">
                <div class="timeline-card">
                    <h3>Recent Symptoms & Life Impact</h3>
                    <div id="symptom-timeline" class="timeline">
                        <!-- Timeline items will be populated here -->
                    </div>
                </div>
                
                <div class="patterns-card">
                    <h3>Pattern Insights</h3>
                    <div id="pattern-insights" class="insights">
                        <p class="no-data">Log more symptoms to see patterns</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Appointment Prep Tab -->
        <div id="appointment" class="tab-content">
            <div class="section-header">
                <h2>Prepare for Your Doctor Visit</h2>
                <p>Organize your symptoms and questions for a productive appointment</p>
            </div>
            
            <div class="appointment-grid">
                <div class="prep-card glass-card">
                    <div class="card-icon">üìÖ</div>
                    <h3>Upcoming Appointment</h3>
                    <div class="form-group">
                        <label class="form-label">Doctor/Clinic</label>
                        <input type="text" id="doctor-name" class="form-input" placeholder="Dr. Smith, Internal Medicine">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Appointment Date</label>
                        <input type="datetime-local" id="appointment-date" class="form-input">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Main Concern</label>
                        <textarea id="visit-reason" class="form-textarea" placeholder="What's the primary reason for this visit?"></textarea>
                    </div>
                    <button class="btn-primary" onclick="saveAppointment()">
                        <span class="btn-icon">üíæ</span>
                        Save Appointment
                    </button>
                </div>

                <div class="prep-card glass-card">
                    <div class="card-icon">‚ùì</div>
                    <h3>Questions for Doctor</h3>
                    <div id="suggested-questions" class="questions-list">
                        <div class="suggested-question">
                            <span class="question-icon">üí°</span>
                            <span>What could be causing these symptoms?</span>
                        </div>
                        <div class="suggested-question">
                            <span class="question-icon">üí°</span>
                            <span>Are there any tests I should consider?</span>
                        </div>
                        <div class="suggested-question">
                            <span class="question-icon">üí°</span>
                            <span>What lifestyle changes might help?</span>
                        </div>
                        <div class="suggested-question">
                            <span class="question-icon">üí°</span>
                            <span>How are these symptoms affecting my daily life?</span>
                        </div>
                    </div>
                    <div class="add-question">
                        <input type="text" id="custom-question" class="form-input" placeholder="Add your own question">
                        <button class="btn-secondary" onclick="addQuestion()">Add</button>
                    </div>
                </div>

                <div class="prep-card glass-card full-width">
                    <div class="card-icon">üìã</div>
                    <h3>Visit Summary & Life Impact Report</h3>
                    <div id="visit-summary" class="visit-summary">
                        <p>Set up an appointment above to see your personalized visit summary with life impact analysis</p>
                    </div>
                    <button class="btn-primary" onclick="generateVisitSummary()">
                        <span class="btn-icon">‚ú®</span>
                        Generate Visit Summary
                    </button>
                </div>
            </div>
        </div>

        <!-- Reports Tab -->
        <div id="reports" class="tab-content">
            <div class="section-header">
                <h2>Medical Reports & Data Export</h2>
                <p>Generate professional reports and export your health data</p>
            </div>
            
            <div class="reports-grid">
                <div class="report-card glass-card">
                    <div class="card-icon">üìä</div>
                    <h3>Report Settings</h3>
                    <div class="form-group">
                        <label class="form-label">Time Period</label>
                        <select id="report-timeframe" class="form-input">
                            <option value="1week">Last week</option>
                            <option value="2weeks">Last 2 weeks</option>
                            <option value="1month">Last month</option>
                            <option value="3months">Last 3 months</option>
                            <option value="6months">Last 6 months</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Include in Report</label>
                        <div class="checkbox-grid">
                            <label class="checkbox-item">
                                <input type="checkbox" checked>
                                <span class="checkmark"></span>
                                Symptom timeline
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" checked>
                                <span class="checkmark"></span>
                                Life impact analysis
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" checked>
                                <span class="checkmark"></span>
                                Sleep correlations
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" checked>
                                <span class="checkmark"></span>
                                Pattern insights
                            </label>
                        </div>
                    </div>
                    <button class="btn-primary" onclick="generateReport()">
                        <span class="btn-icon">üìÑ</span>
                        Generate PDF Report
                    </button>
                    
                    <div class="export-section" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
                        <h4 style="color: #c4b5fd; margin-bottom: 15px;">Export Data</h4>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <button class="btn-secondary" onclick="exportLifeImpactData()">
                                <span class="btn-icon">üì•</span>
                                Export Impact Data
                            </button>
                            <button class="btn-secondary" onclick="exportSleepData()">
                                <span class="btn-icon">üò¥</span>
                                Export Sleep Data
                            </button>
                        </div>
                    </div>
                </div>

                <div class="report-preview-card glass-card">
                    <h3>Report Preview</h3>
                    <div id="report-preview" class="report-preview">
                        <div class="preview-placeholder">
                            <div class="preview-icon">üìã</div>
                            <p>Generate a report to see preview with life impact analysis</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Action Button -->
    <div class="fab" onclick="quickLogSymptom()">
        <span class="fab-icon">+</span>
        <span class="fab-tooltip">Quick Log</span>
    </div>

    <!-- Success Toast -->
    <div id="toast" class="toast">
        <span class="toast-icon">‚úÖ</span>
        <span class="toast-message">Symptom logged successfully!</span>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <p>Processing...</p>
    </div>

    <script src="script.js"></script>

    <!-- Firebase SDKs with Authentication -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, getDocs, doc, updateDoc, deleteDoc, query, orderBy, onSnapshot, where } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getAuth, GoogleAuthProvider, signInWithPopup, signInWithEmailAndPassword, createUserWithEmailAndPassword, signInAnonymously, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        const firebaseConfig = {
          apiKey: "AIzaSyCTT85CYY2DA0E2Jvc7Wv7DI0Iu0WKGz9g",
          authDomain: "medprep-tracker.firebaseapp.com",
          projectId: "medprep-tracker",
          storageBucket: "medprep-tracker.firebasestorage.app",
          messagingSenderId: "816697486441",
          appId: "1:816697486441:web:deac9378ebc4607c5c06f8",
          measurementId: "G-W2F9SEPHFH"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const googleProvider = new GoogleAuthProvider();

        window.db = db;
        window.auth = auth;
        window.googleProvider = googleProvider;
        window.firebaseOperations = {
            collection, addDoc, getDocs, doc, updateDoc, deleteDoc,
            query, orderBy, onSnapshot, where,
            signInWithPopup, signInWithEmailAndPassword, createUserWithEmailAndPassword,
            signInAnonymously, onAuthStateChanged,
            signOut: () => signOut(auth)
        };

        onAuthStateChanged(auth, (user) => {
            if (user) {
                console.log('User signed in:', user.email || 'Anonymous');
                showMainApp(user);
            } else {
                console.log('User signed out');
                showAuthScreen();
            }
        });

        function showMainApp(user) {
            document.getElementById('auth-container').style.display = 'none';
            document.querySelector('.container').style.display = 'block';
            document.getElementById('user-profile').style.display = 'flex';
            
            const avatar = document.getElementById('user-avatar');
            const name = document.getElementById('user-name');
            const email = document.getElementById('user-email');
            
            if (user.isAnonymous) {
                avatar.src = 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%23667eea"/><text x="50" y="60" text-anchor="middle" fill="white" font-size="30">?</text></svg>';
                name.textContent = 'Demo User';
                email.textContent = 'Using demo mode';
            } else {
                avatar.src = user.photoURL || 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%23667eea"/><text x="50" y="60" text-anchor="middle" fill="white" font-size="30">' + (user.displayName ? user.displayName[0] : user.email[0]) + '</text></svg>';
                name.textContent = user.displayName || user.email.split('@')[0];
                email.textContent = user.email;
            }
            
            if (window.symptomTracker) {
                window.symptomTracker.currentUser = user;
                window.symptomTracker.loadUserData();
            } else {
                setTimeout(() => {
                    if (window.symptomTracker) {
                        window.symptomTracker.currentUser = user;
                        window.symptomTracker.loadUserData();
                    }
                }, 1000);
            }
        }

        function showAuthScreen() {
            document.getElementById('auth-container').style.display = 'flex';
            document.querySelector('.container').style.display = 'none';
            document.getElementById('user-profile').style.display = 'none';
        }

        window.signInWithGoogle = async function() {
            try {
                await signInWithPopup(auth, googleProvider);
                console.log('Google sign-in successful');
            } catch (error) {
                console.error('Google sign-in error:', error);
                alert('Sign-in failed: ' + error.message);
            }
        };

        window.signInWithEmail = async function() {
            const email = document.getElementById('auth-email').value;
            const password = document.getElementById('auth-password').value;
            
            if (!email || !password) {
                alert('Please enter both email and password');
                return;
            }
            
            try {
                await signInWithEmailAndPassword(auth, email, password);
                console.log('Email sign-in successful');
            } catch (error) {
                console.error('Email sign-in error:', error);
                alert('Sign-in failed: ' + error.message);
            }
        };

        window.signUpWithEmail = async function() {
            const email = document.getElementById('auth-email').value;
            const password = document.getElementById('auth-password').value;
            
            if (!email || !password) {
                alert('Please enter both email and password');
                return;
            }
            
            if (password.length < 6) {
                alert('Password must be at least 6 characters');
                return;
            }
            
            try {
                await createUserWithEmailAndPassword(auth, email, password);
                console.log('Account created successfully');
            } catch (error) {
                console.error('Sign-up error:', error);
                alert('Account creation failed: ' + error.message);
            }
        };

        window.signInAnonymously = async function() {
            try {
                await signInAnonymously(auth);
                console.log('Anonymous sign-in successful');
            } catch (error) {
                console.error('Anonymous sign-in error:', error);
                alert('Demo mode failed: ' + error.message);
            }
        };

        window.signOut = async function() {
            try {
                await signOut(auth);
                console.log('User signed out');
            } catch (error) {
                console.error('Sign-out error:', error);
            }
        };

        window.toggleEmailAuth = function() {
            const form = document.getElementById('email-auth-form');
            const isHidden = form.style.display === 'none';
            form.style.display = isHidden ? 'block' : 'none';
            
            if (isHidden) {
                document.getElementById('auth-email').focus();
            }
        };

        console.log('Firebase Authentication initialized');
    </script>
</body>
</html>